<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=91ea5fd278223521e857ad81684db507&libraries=services"></script>
    <title>Main</title>
        <style>

        a:visited {color:white}

        .imgcon2{
            float: left;
            height: 50px;
            padding: 10px 40px;
        }

        navbar{
            float: right;
            display: flex;
            flex-direction: row;
            width: 100%;
            list-style-type: none;
            position: fixed;
            color: white;
        }

        nav-item{
            padding: 15px;
            cursor: pointer;
        }

        li{
            float:right;
            padding: 20px 40px;
        }

        body {
            font-family: 'Noto Sans KR' !important;
            margin: 0;
            background-color: rgb(47, 48, 58);
            display: grid;
            grid-template-rows: 1fr 20fr;
            color: white;
            height: 100vh;
        }

        .wrapper {
            display: grid;
            grid-template-rows: 1fr 20fr;
        }

        .names {
            display: grid;
            grid-template-columns: 1.5fr 1fr 1fr;
            place-items: center;
            font-weight: 500;
        }

        .items {
            display: grid;
            grid-template-columns: 1.5fr 2fr;
        }

        .map {

        }

        .details {
            display: grid;
            grid-template-rows: 1fr 5fr;
        }

        .calendar {
            display: flex;
        }
        .locationGames {
            display: grid;
            grid-template-columns: 1fr 1fr;
        }

        .location {
            display: flex;
            flex-direction: column;
            flex-wrap: wrap;
            align-items: center;
            overflow-y: scroll;
            overflow: hidden;
        }

        .games {
            display: flex;
            flex-direction: column;
            flex-wrap: wrap;
            align-items: center;
            overflow-y: scroll;
            overflow: hidden;
        }

        .game {
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: space-between;
            width: 80%;
            padding-left: 5px;
            height: 50px;
            margin-top: 8px;
            background-color: rgb(75 77 92);
            border-radius: 15px;
            border-color: transparent;
            transition: 300ms;
            color: white;
        }

    </style>


</head>
<body>
    {% load static %}
    <div class="header">
        <div class="imgcon2"><img src="{% static 'img/veteran_logo.png' %}" alt=""></div>
        <ul class="navbar">
            <p style="color:white;">{{ user.username }}</p>
            <li class="nav-item"><a href="{% url 'Account:mypage' %}">üë§ ÎÇ¥ Ï†ïÎ≥¥</a></li>
        </ul>
    </div>
    <div class="wrapper">
        <div class="names">
            <div> Í≤åÏûÑ Î¶¨Ïä§Ìä∏ </div>
        </div>
        <div class="items" style='display:flex; flex-direction:row; flex-wrap:wrap; justify-content:space-around;'>
            <!--ÏßÄÎèÑ ÌëúÏãú Î∂ÄÎ∂Ñ-->
            <div class="map" id='map' style="min-width:850px; height: 850px; background-color:white;"></div>

            <!--Í≤ΩÍ∏∞ Î¶¨Ïä§Ìä∏ Î∂ÄÎ∂Ñ-->
            <div class="details" style="display:flex; flex-direction:column; justify-content:space-around;">
                <div id='calendar'></div>
                {% for game in game_list %}
                <div class="games" style="background-color: transparent; padding:5px;">
                    <div>
                        {{ game.host }} | {{ game.numOfParticipation }}/{{ game.numOfRecruitment }}
                    </div>
                    <div>
                        {{ game.start_datetime }}  
                        <a href="{% url 'Game:participate' game.id %}">Ï∞∏Í∞ÄÏã†Ï≤≠<a>
                    </div>

                </div>
                {% endfor %}

            </div>
        </div>

    </div>


    <script>
        //ÏßÄÎèÑ ÏÉùÏÑ±
        var container = document.getElementById('map');
        var option = {
            center : new kakao.maps.LatLng(37.59727,127.05884),
            level:3
        };

        const map = new kakao.maps.Map(container,option);
        const markers=[];

        // Ï£ºÏÜå-Ï¢åÌëú Î≥ÄÌôò Í∞ùÏ≤¥ ÏÉùÏÑ±
        var geocoder = new kakao.maps.services.Geocoder();

        //ÌòÑÏû¨ ÏÇ¨Ïö©Ïûê ÏúÑÏπò Ï¢åÌëú Î∞òÌôò Î©îÏÜåÎìú
        function getCurrentLocation(){
            if (navigator.geolocation){
                navigator.geolocation.getCurrentPosition(function(position){
                    var lat=position.coords.latitude,
                    lon=position.coords.longitude;
                    var locPosition=new kakao.maps.LatLng(lat,lon)
                });
            }else {
                var locPosition=new kakao.maps.LatLng(33.450701,126.590667);
            }
            return locPosition;
        }

        //ÏÇ¨Ïö©Ïûê ÏúÑÏπò ÏßÄÎèÑÏóê ÌëúÏãú    
        if (navigator.geolocation){
            navigator.geolocation.getCurrentPosition(function(position){
                var lat=position.coords.latitude,
                lon=position.coords.longitude;
                
                var locPosition=new kakao.maps.LatLng(lat,lon),
                message='<div style="padding:3px;">here!</div>';


                map.setCenter(locPosition);
                


                displayMarker(locPosition,message);
            });
            } 
            else {
                var locPosition=new kakao.maps.LatLng(33.450701,126.590667),
                message="error!"
                displayMarker(locPosition,message);
            }

        function displayMarker(locPosition,message){
            var marker=new kakao.maps.Marker({
                map:map,
                position:locPosition
            });

            var iwContent = message,
            iwRemovable = true;

            map.setCenter(locPosition);
        }


    </script>


    
</body>
</html>